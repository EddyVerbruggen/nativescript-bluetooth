{"version":3,"sources":["bluetooth.ios.ts"],"names":[],"mappings":";AAAA,yCAAyC;AACzC,iCAAwB,oBAAoB,CAAC,CAAA;AAE7C,IAAI,SAAS,GAAG,IAAI,4BAAS,CAAC;AAE9B,SAAS,CAAC,MAAM,GAAG;IACjB,OAAO,EAAE,IAAI;IACb,eAAe,EAAE,IAAI;IACrB,eAAe,EAAE,IAAI;IACrB,gBAAgB,EAAE,EAAE;IACpB,mBAAmB,EAAE,EAAE;IACvB,YAAY,EAAE,IAAI;CACnB,CAAC;AAEF,IAAI,wBAAwB,GAAG,CAAC,UAAU,MAAM;IAC9C,SAAS,CAAC,wBAAwB,EAAE,MAAM,CAAC,CAAC;IAC5C;QACE,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAChC,CAAC;IACD,wBAAwB,CAAC,GAAG,GAAG;QAC7B,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,QAAQ;QACtE,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,uBAAuB;QACvB,IAAI,CAAC,4BAA4B,GAAG,EAAE,CAAC;QACvC,MAAM,CAAC,IAAI,CAAC;IACd,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,6BAA6B,GAAG,UAAS,UAAU,EAAE,KAAK;QAC3F,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC,CAAC;QAE5D,qCAAqC;QACrC,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;QACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YACnD,IAAI,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACnD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;gBAClB,IAAI,EAAE,OAAO,CAAC,IAAI,CAAC,UAAU;gBAC7B,IAAI,EAAE,OAAO,CAAC,IAAI;aACnB,CAAC,CAAC;YACH,6BAA6B;YAC7B,UAAU,CAAC,iCAAiC,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAC9D,CAAC;IACH,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,oDAAoD,GAAG,UAAS,UAAU,EAAE,OAAO,EAAE,KAAK;QAC3H,OAAO,CAAC,GAAG,CAAC,uEAAuE,CAAC,CAAC;IACvF,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,cAAc,GAAG,UAAS,cAAc;QACzE,IAAI,KAAK,GAAG,cAAc,CAAC,UAAU,CAAC;QACtC,MAAM,CAAC;YACL,SAAS,EAAE,CAAC,KAAK,GAAG,iCAAiC,CAAC,IAAI,iCAAiC;YAC3F,IAAI,EAAE,CAAC,KAAK,GAAG,4BAA4B,CAAC,IAAI,4BAA4B;YAC5E,UAAU,EAAE,CAAC,KAAK,GAAG,iCAAiC,CAAC,IAAI,iCAAiC;YAC5F,KAAK,EAAE,CAAC,KAAK,GAAG,4BAA4B,CAAC,IAAI,4BAA4B;YAC7E,KAAK,EAAE,CAAC,KAAK,GAAG,6BAA6B,CAAC,IAAI,6BAA6B;YAC/E,oBAAoB,EAAE,CAAC,KAAK,GAAG,4CAA4C,CAAC,IAAI,4CAA4C;YAC5H,MAAM,EAAE,CAAC,KAAK,GAAG,8BAA8B,CAAC,IAAI,8BAA8B;YAClF,QAAQ,EAAE,CAAC,KAAK,GAAG,gCAAgC,CAAC,IAAI,gCAAgC;YACxF,yBAAyB,EAAE,CAAC,KAAK,GAAG,iDAAiD,CAAC,IAAI,iDAAiD;YAC3I,kBAAkB,EAAE,CAAC,KAAK,GAAG,0CAA0C,CAAC,IAAI,0CAA0C;YACtH,wBAAwB,EAAE,CAAC,KAAK,GAAG,gDAAgD,CAAC,IAAI,gDAAgD;YACxI,0BAA0B,EAAE,CAAC,KAAK,GAAG,kDAAkD,CAAC,IAAI,kDAAkD;SAC/I,CAAC;IACJ,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,eAAe,GAAG,UAAS,cAAc;QAC1E,IAAI,KAAK,GAAG,cAAc,CAAC,WAAW,CAAC;QACvC,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YACrC,IAAI,IAAI,GAAG,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAClC,OAAO,CAAC,GAAG,CAAC,8BAA8B,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;YACzD,OAAO,CAAC,IAAI,CAAC;gBACX,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,UAAU;gBAC1B,KAAK,EAAE,IAAI,CAAC,KAAK;aAClB,CAAC,CAAC;QACL,CAAC;QACD,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,mDAAmD,GAAG,UAAS,UAAU,EAAE,OAAO,EAAE,KAAK;QAC1H,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACV,yCAAyC;YACzC,MAAM,CAAC;QACT,CAAC;QACD,IAAI,eAAe,GAAG,EAAE,CAAC;QACzB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YACvD,IAAI,cAAc,GAAG,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAC9D,IAAI,MAAM,GAAG;gBACX,IAAI,EAAE,cAAc,CAAC,IAAI,CAAC,UAAU;gBACpC,IAAI,EAAE,cAAc,CAAC,IAAI;gBACzB,kEAAkE;gBAClE,KAAK,EAAE,cAAc,CAAC,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAAC,GAAG,IAAI;gBAC3F,UAAU,EAAE,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC;gBAC/C,mGAAmG;gBACnG,WAAW,EAAE,cAAc,CAAC,WAAW;gBACvC,WAAW,EAAE,cAAc,CAAC,WAAW,CAAC,wBAAwB;aACjE,CAAC;YACF,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAE7B,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC3C,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;gBAC1B,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;oBACtC,CAAC,CAAC,eAAe,GAAG,eAAe,CAAC;oBACpC,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;oBAC1C,gFAAgF;oBAChF,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAC5B,KAAK,CAAC;gBACR,CAAC;YACH,CAAC;QAIH,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;YAChC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;gBACnB,IAAI,CAAC,SAAS,CAAC;oBACb,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,UAAU;oBACtC,IAAI,EAAE,UAAU,CAAC,IAAI;oBACrB,KAAK,EAAE,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC;oBAC5C,QAAQ,EAAE,IAAI,CAAC,4BAA4B;iBAC5C,CAAC,CAAC;gBACH,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IAEF,wBAAwB,CAAC,SAAS,CAAC,cAAc,GAAG,UAAS,KAAK;QAChE,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,IAAI,CAAC;QACd,CAAC;QAED,gCAAgC;QAChC,IAAI,CAAC,GAAG,KAAK,CAAC,8BAA8B,CAAC,CAAC,CAAC,CAAC;QAChD,MAAM,CAAC,SAAS,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC;IAEF,wDAAwD;IACxD,wBAAwB,CAAC,SAAS,CAAC,8CAA8C,GAAG,UAAS,UAAU,EAAE,cAAc,EAAE,KAAK;QAC5H,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,4DAA4D,CAAC,CAAC;YAC1E,MAAM,CAAC;QACT,CAAC;QAED,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;YACnB,sCAAsC;YACtC,OAAO,CAAC,GAAG,CAAC,sEAAsE,CAAC,CAAC;YACpF,MAAM,CAAC;QACT,CAAC;QAED,IAAI,MAAM,GAAG;YACX,IAAI,EAAE,cAAc,CAAC,WAAW,GAAG,cAAc,GAAG,MAAM;YAC1D,kBAAkB,EAAE,cAAc,CAAC,IAAI,CAAC,UAAU;YAClD,QAAQ,EAAE,cAAc,CAAC,KAAK;YAC9B,KAAK,EAAE,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,KAAK,CAAC;SACjD,CAAC;QAEF,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC,CAAC,CAAC;YAC3B,EAAE,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;gBACxB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;YAC9B,CAAC;YAAC,IAAI,CAAC,CAAC;gBACR,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;YACxC,CAAC;QACH,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC;gBAC3B,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YACjC,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;YAC5C,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,6CAA6C,GAAG,UAAS,UAAU,EAAE,cAAc,EAAE,KAAK;QAC3H,OAAO,CAAC,GAAG,CAAC,gEAAgE,CAAC,CAAC;QAC9E,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,eAAe,CAAC;gBACnB,kBAAkB,EAAE,cAAc,CAAC,IAAI,CAAC,UAAU;aACnD,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,OAAO,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;QAC3C,CAAC;IACH,CAAC,CAAC;IAEF,mFAAmF;IACnF,wBAAwB,CAAC,SAAS,CAAC,0DAA0D,GAAG,UAAS,UAAU,EAAE,cAAc,EAAE,KAAK;QACxI,OAAO,CAAC,GAAG,CAAC,sFAAsF,GAAG,KAAK,CAAC,CAAC;QAC5G,uEAAuE;QACvE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACV,OAAO,CAAC,GAAG,CAAC,oGAAoG,GAAG,KAAK,CAAC,oBAAoB,CAAC,CAAC;QACjJ,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,EAAE,CAAC,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,CAAC;gBAC/B,OAAO,CAAC,GAAG,CAAC,+BAA+B,GAAG,cAAc,CAAC,CAAC;YAChE,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,iCAAiC,GAAG,cAAc,GAAG,yBAAyB,CAAC,CAAC;YAE9F,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,sDAAsD,GAAG,UAAS,UAAU,EAAE,cAAc,EAAE,KAAK;QAEpI,2EAA2E;QAE3E,OAAO,CAAC,GAAG,CAAC,yEAAyE,CAAC,CAAC;QACvF,OAAO,CAAC,GAAG,CAAC,gGAAgG,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;QAErI,mIAAmI;QACnI,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;QACxC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,cAAc,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YAC1D,IAAI,UAAU,GAAG,cAAc,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAC7D,OAAO,CAAC,GAAG,CAAC,kBAAkB,GAAG,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAC/D,CAAC;QAED,sDAAsD;QACtD,0CAA0C;QAC1C,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,IAAI,CAAC,4BAA4B,CAAC,MAAM,CAAC,CAAC,CAAC;YACtE,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;gBACnB,IAAI,CAAC,SAAS,CAAC;oBACb,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,UAAU;oBACtC,IAAI,EAAE,UAAU,CAAC,IAAI;oBACrB,KAAK,EAAE,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC;oBAC5C,QAAQ,EAAE,IAAI,CAAC,SAAS;iBACzB,CAAC,CAAC;gBACH,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACxB,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,0CAA0C,GAAG,UAAS,UAAU,EAAE,UAAU,EAAE,KAAK;QACpH,OAAO,CAAC,GAAG,CAAC,6DAA6D,CAAC,CAAC;IAC7E,CAAC,CAAC;IACF,wBAAwB,CAAC,SAAS,CAAC,yCAAyC,GAAG,UAAS,UAAU,EAAE,UAAU,EAAE,KAAK;QACnH,OAAO,CAAC,GAAG,CAAC,4DAA4D,CAAC,CAAC;IAC5E,CAAC,CAAC;IACF,wBAAwB,CAAC,aAAa,GAAG,CAAC,oBAAoB,CAAC,CAAC;IAChE,MAAM,CAAC,wBAAwB,CAAC;AAClC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;AAGb,IAAI,4BAA4B,GAAG,CAAC,UAAU,MAAM;IAClD,SAAS,CAAC,4BAA4B,EAAE,MAAM,CAAC,CAAC;IAChD;QACE,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAChC,CAAC;IACD,4BAA4B,CAAC,GAAG,GAAG;QACjC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,QAAQ;QAC1E,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,MAAM,CAAC,IAAI,CAAC;IACd,CAAC,CAAC;IACF,4EAA4E;IAC5E,4BAA4B,CAAC,SAAS,CAAC,wDAAwD,GAAG,UAAS,OAAO,EAAE,UAAU,EAAE,OAAO,EAAE,IAAI;QAC3I,OAAO,CAAC,GAAG,CAAC,uDAAuD,GAAG,UAAU,CAAC,IAAI,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC;QACtG,IAAI,IAAI,GAAG,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACvE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YACV,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;YACvD,EAAE,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC;gBAClC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC;oBAC5B,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,UAAU;oBACtC,IAAI,EAAE,UAAU,CAAC,IAAI;oBACrB,IAAI,EAAE,IAAI;oBACV,KAAK,EAAE,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC;iBAC7C,CAAC,CAAC;YACL,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,8CAA8C,CAAC,CAAC;YAC9D,CAAC;QACH,CAAC;IACH,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,4BAA4B,GAAG,UAAS,OAAO;QACpF,OAAO,CAAC,GAAG,CAAC,+CAA+C,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;QAC7E,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,IAAI,gCAAgC,CAAC,CAAC,CAAC;YACtD,OAAO,CAAC,GAAG,CAAC,+DAA+D,CAAC,CAAC;QAC/E,CAAC;IACH,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,8BAA8B,GAAG,UAAS,OAAO,EAAE,IAAI;QAC5F,OAAO,CAAC,GAAG,CAAC,gDAAgD,CAAC,CAAC;IAChE,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,kCAAkC,GAAG,UAAS,OAAO,EAAE,UAAU;QACtG,OAAO,CAAC,GAAG,CAAC,sDAAsD,GAAG,UAAU,CAAC,CAAC;QAEjF,6DAA6D;QAC7D,IAAI,IAAI,GAAG,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QACvE,OAAO,CAAC,GAAG,CAAC,oEAAoE,GAAG,IAAI,CAAC,CAAC;QAEzF,IAAI,EAAE,GAAG,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAC7E,IAAI,QAAQ,GAAG,wBAAwB,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC;QACnE,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,OAAO,CAAC,GAAG,CAAC,4EAA4E,CAAC,CAAC;QAC1F,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,0CAA0C,GAAG,UAAS,OAAO,EAAE,UAAU,EAAE,KAAK;QACrH,wFAAwF;QACxF,IAAI,EAAE,GAAG,SAAS,CAAC,MAAM,CAAC,mBAAmB,CAAC,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;QAChF,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACP,EAAE,CAAC;gBACD,IAAI,EAAE,UAAU,CAAC,UAAU,CAAC,UAAU;gBACtC,IAAI,EAAE,UAAU,CAAC,IAAI;aACtB,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAC;QACxD,CAAC;QACD,IAAI,OAAO,GAAG,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;QACzE,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;IACzD,CAAC,CAAC;IACF,4BAA4B,CAAC,SAAS,CAAC,6CAA6C,GAAG,UAAS,OAAO,EAAE,UAAU,EAAE,KAAK;QACxH,wBAAwB;QACxB,OAAO,CAAC,GAAG,CAAC,gEAAgE,CAAC,CAAC;QAC9E,yBAAyB;IAC3B,CAAC,CAAC;IACF,4BAA4B,CAAC,aAAa,GAAG,CAAC,wBAAwB,CAAC,CAAC;IACxE,MAAM,CAAC,4BAA4B,CAAC;AACtC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;AAEb,8DAA8D;AAC9D,CAAC;IACC,SAAS,CAAC,MAAM,CAAC,eAAe,GAAG,4BAA4B,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC,UAAU,GAAG;QAClG,OAAO,CAAC,GAAG,CAAC,6BAA6B,GAAG,GAAG,CAAC,CAAC;IACnD,CAAC,CAAC,CAAC;IACH,sHAAsH;IACtH,SAAS,CAAC,MAAM,CAAC,OAAO,GAAG,gBAAgB,CAAC,KAAK,EAAE,CAAC,qBAAqB,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;AACpH,CAAC,CAAC,EAAE,CAAC;AAEL,SAAS,CAAC,UAAU,GAAG,UAAU,GAAG;IAClC,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,IAAI,8BAA8B,CAAC;AAC1E,CAAC,CAAC;AAEF,SAAS,CAAC,SAAS,GAAG,UAAS,OAAO;IACpC,EAAE,CAAC,CAAC,OAAO,IAAI,2BAA2B,CAAC,CAAC,CAAC;QAC3C,MAAM,CAAC,YAAY,CAAC;IACtB,CAAC;IAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,0BAA0B,CAAC,CAAC,CAAC;QACjD,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;IAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,6BAA6B,CAAC,CAAC,CAAC;QACpD,MAAM,CAAC,cAAc,CAAC;IACxB,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,OAAO,CAAC,GAAG,CAAC,8CAA8C,GAAG,OAAO,CAAC,CAAC;QACtE,MAAM,CAAC,cAAc,CAAC;IACxB,CAAC;AACH,CAAC,CAAC;AAEF,SAAS,CAAC,kBAAkB,GAAG,UAAU,GAAG;IAC1C,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,OAAO,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC;QAClC,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,yCAAyC,GAAG,EAAE,CAAC,CAAC;YAC5D,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,aAAa,GAAG,UAAU,GAAG;IACrC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnC,MAAM,CAAC;YACT,CAAC;YACD,SAAS,CAAC,MAAM,CAAC,eAAe,GAAG,cAAc,CAAC,GAAG,EAAE,CAAC;YAExD,6HAA6H;YAC7H,SAAS,CAAC,MAAM,CAAC,YAAY,GAAG,GAAG,CAAC,YAAY,CAAC;YACjD,IAAI,YAAY,GAAG,GAAG,CAAC,YAAY,IAAI,EAAE,CAAC;YAE1C,IAAI,QAAQ,GAAG,EAAE,CAAC;YAClB,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,YAAY,CAAC,CAAC,CAAC;gBAC3B,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACxD,CAAC;YACD,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,qCAAqC,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YAC/E,EAAE,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;gBAChB,UAAU,CAAC;oBACT,gFAAgF;oBAChF,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;oBACpC,OAAO,EAAE,CAAC;gBACZ,CAAC,EAAE,GAAG,CAAC,OAAO,GAAG,IAAI,CAAC,CAAC;YACzB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,EAAE,CAAC;YACZ,CAAC;QACH,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,oCAAoC,GAAG,EAAE,CAAC,CAAC;YACvD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,YAAY,GAAG,UAAU,GAAG;IACpC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnC,MAAM,CAAC;YACT,CAAC;YACD,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;YACpC,OAAO,EAAE,CAAC;QACZ,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,mCAAmC,GAAG,EAAE,CAAC,CAAC;YACtD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,eAAe,GAAG,UAAS,IAAI;IACvC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;QAChE,IAAI,UAAU,GAAG,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;QACnE,EAAE,CAAC,CAAC,IAAI,IAAI,UAAU,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC;YAC7C,MAAM,CAAC,UAAU,CAAC;QACpB,CAAC;IACH,CAAC;IACD,MAAM,CAAC,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,gEAAgE;AAChE,SAAS,CAAC,OAAO,GAAG,UAAU,GAAG;IAC/B,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnC,MAAM,CAAC;YACT,CAAC;YACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;gBACd,MAAM,CAAC,oBAAoB,CAAC,CAAC;gBAC7B,MAAM,CAAC;YACT,CAAC;YACD,IAAI,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACrD,EAAE,CAAC,CAAC,UAAU,KAAK,IAAI,CAAC,CAAC,CAAC;gBACxB,MAAM,CAAC,sCAAsC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;YAC5D,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,sCAAsC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC/D,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,WAAW,CAAC;gBAC9D,SAAS,CAAC,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,cAAc,CAAC;gBACpE,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,wBAAwB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;gBACpE,OAAO,EAAE,CAAC;YACZ,CAAC;QACH,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,8BAA8B,GAAG,EAAE,CAAC,CAAC;YACjD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,UAAU,GAAG,UAAU,GAAG;IAClC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnC,MAAM,CAAC;YACT,CAAC;YACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;gBACd,MAAM,CAAC,oBAAoB,CAAC,CAAC;gBAC7B,MAAM,CAAC;YACT,CAAC;YACD,IAAI,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACrD,EAAE,CAAC,CAAC,UAAU,KAAK,IAAI,CAAC,CAAC,CAAC;gBACxB,MAAM,CAAC,sCAAsC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;YAC5D,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,sCAAsC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;gBAC/D,gFAAgF;gBAChF,EAAE,CAAC,CAAC,UAAU,CAAC,KAAK,IAAI,6BAA6B,CAAC,CAAC,CAAC;oBACtD,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,0BAA0B,CAAC,UAAU,CAAC,CAAC;oBAChE,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;gBAE7B,CAAC;gBACD,OAAO,EAAE,CAAC;YACZ,CAAC;QACH,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,iCAAiC,GAAG,EAAE,CAAC,CAAC;YACpD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,WAAW,GAAG,UAAU,GAAG;IACnC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;gBACnC,MAAM,CAAC;YACT,CAAC;YACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;gBACd,MAAM,CAAC,oBAAoB,CAAC,CAAC;gBAC7B,MAAM,CAAC;YACT,CAAC;YACD,IAAI,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACrD,EAAE,CAAC,CAAC,UAAU,KAAK,IAAI,CAAC,CAAC,CAAC;gBACxB,MAAM,CAAC,sCAAsC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;YAC5D,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,OAAO,CAAC,GAAG,CAAC,4CAA4C,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;gBACrE,OAAO,CAAC,UAAU,CAAC,KAAK,IAAI,0BAA0B,CAAC,CAAC;YAC1D,CAAC;QACH,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,kCAAkC,GAAG,EAAE,CAAC,CAAC;YACrD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,YAAY,GAAG,UAAU,IAAI,EAAE,UAAU;IACjD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;QACnD,IAAI,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;QACnD,oDAAoD;QACpD,4FAA4F;QAC5F,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;YAC/C,mEAAmE;YACnE,MAAM,CAAC,OAAO,CAAC;QACjB,CAAC;IACH,CAAC;IACD,uCAAuC;IACvC,MAAM,CAAC,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,SAAS,CAAC,mBAAmB,GAAG,UAAU,IAAI,EAAE,OAAO,EAAE,QAAQ;IAC/D,wDAAwD;IACxD,8DAA8D;IAC9D,OAAO,CAAC,GAAG,CAAC,2CAA2C,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;IACnF,kGAAkG;IAClG,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;QACvD,IAAI,cAAc,GAAG,OAAO,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;QAC9D,kEAAkE;QAClE,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,IAAI,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;YACtD,EAAE,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACb,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,UAAU,GAAG,QAAQ,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC;oBACvD,mEAAmE;oBACnE,MAAM,CAAC,cAAc,CAAC;gBACxB,CAAC;YACH,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,MAAM,CAAC,cAAc,CAAC;YACxB,CAAC;QACH,CAAC;IACH,CAAC;IACD,2CAA2C;IAC3C,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;IAC7C,MAAM,CAAC,IAAI,CAAC;AACd,CAAC,CAAC;AAEF,SAAS,CAAC,WAAW,GAAG,UAAU,GAAG,EAAE,QAAQ,EAAE,MAAM;IACrD,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;QAC5B,MAAM,CAAC,0BAA0B,CAAC,CAAC;QACnC,MAAM,CAAC;IACT,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC;QACxB,MAAM,CAAC,8BAA8B,CAAC,CAAC;QACvC,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC;QACrB,MAAM,CAAC,2BAA2B,CAAC,CAAC;QACpC,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IACD,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAC;QAC5B,MAAM,CAAC,kCAAkC,CAAC,CAAC;QAC3C,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,IAAI,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;IAC/D,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;QAChB,MAAM,CAAC,sCAAsC,GAAG,GAAG,CAAC,cAAc,CAAC,CAAC;QACpE,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,EAAE,CAAC,CAAC,UAAU,CAAC,KAAK,IAAI,0BAA0B,CAAC,CAAC,CAAC;QACnD,MAAM,CAAC,gCAAgC,CAAC,CAAC;QACzC,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,IAAI,WAAW,GAAG,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IACzD,IAAI,OAAO,GAAG,SAAS,CAAC,YAAY,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC;IAC9D,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;QACb,MAAM,CAAC,mCAAmC,GAAG,GAAG,CAAC,WAAW,GAAG,2BAA2B,GAAG,GAAG,CAAC,cAAc,CAAC,CAAC;QACjH,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,IAAI,kBAAkB,GAAG,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;IACvE,IAAI,cAAc,GAAG,SAAS,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IAE1F,gGAAgG;IAChG,EAAE,CAAC,CAAC,QAAQ,IAAI,8BAA8B,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC;QAClE,cAAc,GAAG,SAAS,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,OAAO,EAAE,gCAAgC,CAAC,CAAC;IAChH,CAAC;IAED,mHAAmH;IACnH,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;QACpB,cAAc,GAAG,SAAS,CAAC,mBAAmB,CAAC,kBAAkB,EAAE,OAAO,CAAC,CAAC;IAC9E,CAAC;IAED,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;QACpB,MAAM,CAAC,0CAA0C,GAAG,GAAG,CAAC,kBAAkB,GAAG,wBAAwB,GAAG,GAAG,CAAC,WAAW,GAAG,2BAA2B,GAAG,GAAG,CAAC,cAAc,CAAC,CAAC;QAC5K,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IAED,oGAAoG;IACpG,MAAM,CAAC;QACL,UAAU,EAAE,UAAU;QACtB,OAAO,EAAE,OAAO;QAChB,cAAc,EAAE,cAAc;KAC/B,CAAC;AACJ,CAAC,CAAC;AAEF,SAAS,CAAC,IAAI,GAAG,UAAU,GAAG;IAC5B,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,IAAI,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,4BAA4B,EAAE,MAAM,CAAC,CAAC;YAC/E,EAAE,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;gBACrB,gDAAgD;gBAChD,MAAM,CAAC;YACT,CAAC;YAED,4DAA4D;YAC5D,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,cAAc,GAAG,OAAO,CAAC;YACrD,OAAO,CAAC,UAAU,CAAC,0BAA0B,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;QACxE,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,2BAA2B,GAAG,EAAE,CAAC,CAAC;YAC9C,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,cAAc,GAAG,UAAU,GAAG;IACtC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,IAAI,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,8BAA8B,EAAE,MAAM,CAAC,CAAC;YACjF,OAAO,CAAC,GAAG,CAAC,oCAAoC,GAAG,OAAO,CAAC,CAAC;YAE5D,EAAE,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;gBACrB,gDAAgD;gBAChD,MAAM,CAAC;YACT,CAAC;YACD,IAAI,EAAE,GAAG,GAAG,CAAC,QAAQ,IAAI,UAAS,MAAM,IAAI,OAAO,CAAC,GAAG,CAAC,gEAAgE,CAAC,CAAC,CAAC,CAAC,CAAC;YAE7H,4DAA4D;YAC5D,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,iBAAiB,GAAG,EAAE,CAAC;YACnD,OAAO,CAAC,UAAU,CAAC,+BAA+B,CAAC,IAAI,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;YACjF,OAAO,EAAE,CAAC;QACZ,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,qCAAqC,GAAG,EAAE,CAAC,CAAC;YACxD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,aAAa,GAAG,UAAU,GAAG;IACrC,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,IAAI,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,8BAA8B,EAAE,MAAM,CAAC,CAAC;YACjF,OAAO,CAAC,GAAG,CAAC,mCAAmC,GAAG,OAAO,CAAC,CAAC;YAE3D,EAAE,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;gBACrB,gDAAgD;gBAChD,MAAM,CAAC;YACT,CAAC;YAED,IAAI,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YAC/D,8BAA8B;YAC9B,UAAU,CAAC,+BAA+B,CAAC,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,CAAC;YAC1E,OAAO,EAAE,CAAC;QACZ,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,oCAAoC,GAAG,EAAE,CAAC,CAAC;YACvD,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,mHAAmH;AACnH,SAAS,CAAC,YAAY,GAAG,UAAS,GAAG;IACnC,gDAAgD;IAChD,EAAE,CAAC,CAAC,OAAO,GAAG,IAAI,QAAQ,CAAC,CAAC,CAAC;QAC3B,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC;IACpB,CAAC;IACD,IAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC3B,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAChC,MAAM,CAAC,IAAI,CAAC;IACd,CAAC;IACD,IAAI,MAAM,CAAC;IACX,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC;QACzB,MAAM,GAAG,IAAI,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACxC,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,sBAAsB;QACtB,MAAM,GAAG,IAAI,WAAW,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;IACzC,CAAC;IACD,GAAG,CAAC,CAAC,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;QAClC,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACvB,CAAC;IACD,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC;AACvB,CAAC,CAAC;AAEF,SAAS,CAAC,KAAK,GAAG,UAAU,GAAG;IAC7B,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;gBACf,MAAM,CAAC,gEAAgE,CAAC,CAAC;gBACzE,MAAM,CAAC;YACT,CAAC;YACD,IAAI,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,6BAA6B,EAAE,MAAM,CAAC,CAAC;YAChF,EAAE,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;gBACrB,gDAAgD;gBAChD,MAAM,CAAC;YACT,CAAC;YAED,IAAI,YAAY,GAAG,SAAS,CAAC,YAAY,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACrD,EAAE,CAAC,CAAC,YAAY,KAAK,IAAI,CAAC,CAAC,CAAC;gBAC1B,MAAM,CAAC,iBAAiB,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC;gBACtC,MAAM,CAAC;YACT,CAAC;YAED,sEAAsE;YACtE,8DAA8D;YAC9D,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,eAAe,GAAG,OAAO,CAAC;YAEtD,OAAO,CAAC,UAAU,CAAC,+BAA+B,CAChD,YAAY,EACZ,OAAO,CAAC,cAAc,EACtB,iCAAiC,CAAC,CAAC;QAEvC,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,4BAA4B,GAAG,EAAE,CAAC,CAAC;YAC/C,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,SAAS,CAAC,oBAAoB,GAAG,UAAU,GAAG;IAC5C,MAAM,CAAC,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM;QAC1C,IAAI,CAAC;YACH,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;gBACf,MAAM,CAAC,gEAAgE,CAAC,CAAC;gBACzE,MAAM,CAAC;YACT,CAAC;YACD,IAAI,OAAO,GAAG,SAAS,CAAC,WAAW,CAAC,GAAG,EAAE,4CAA4C,EAAE,MAAM,CAAC,CAAC;YAC/F,EAAE,CAAC,CAAC,OAAO,KAAK,IAAI,CAAC,CAAC,CAAC;gBACrB,gDAAgD;gBAChD,MAAM,CAAC;YACT,CAAC;YAED,IAAI,YAAY,GAAG,SAAS,CAAC,YAAY,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACrD,OAAO,CAAC,GAAG,CAAC,iCAAiC,GAAG,YAAY,CAAC,CAAC;YAE9D,OAAO,CAAC,UAAU,CAAC,+BAA+B,CAChD,YAAY,EACZ,OAAO,CAAC,cAAc,EACtB,oCAAoC,CAAC,CAAC;YAExC,OAAO,EAAE,CAAC;QACZ,CAAE;QAAA,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACZ,OAAO,CAAC,GAAG,CAAC,2CAA2C,GAAG,EAAE,CAAC,CAAC;YAC9D,MAAM,CAAC,EAAE,CAAC,CAAC;QACb,CAAC;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC","file":"bluetooth.ios.js","sourcesContent":["/// <reference path=\"_references.d.ts\" />\r\nimport {bluetooth} from \"./bluetooth-common\";\r\n\r\nvar Bluetooth = new bluetooth;\r\n\r\nBluetooth._state = { \r\n  manager: null,\r\n  centralDelegate: null,\r\n  peripheralArray: null,\r\n  connectCallbacks: {},\r\n  disconnectCallbacks: {},\r\n  onDiscovered: null\r\n};\r\n\r\nvar CBPeripheralDelegateImpl = (function (_super) {\r\n  __extends(CBPeripheralDelegateImpl, _super);\r\n  function CBPeripheralDelegateImpl() {\r\n    _super.apply(this, arguments);\r\n  }\r\n  CBPeripheralDelegateImpl.new = function () {\r\n    return _super.new.call(this);\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.initWithCallback = function (callback) {\r\n    this._callback = callback;\r\n    // this._services = [];\r\n    this._servicesWithCharacteristics = [];\r\n    return this;\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidDiscoverServices = function(peripheral, error) {\r\n    console.log(\"----- delegate peripheralDidDiscoverServices\");\r\n\r\n    // map native services to a JS object\r\n    this._services = [];\r\n    for (var i = 0; i < peripheral.services.count; i++) {\r\n      var service = peripheral.services.objectAtIndex(i);\r\n      this._services.push({\r\n        UUID: service.UUID.UUIDString,\r\n        name: service.UUID\r\n      });\r\n      // NOTE: discover all is slow\r\n      peripheral.discoverCharacteristicsForService(null, service);\r\n    }\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidDiscoverIncludedServicesForServiceError = function(peripheral, service, error) {\r\n    console.log(\"----- delegate peripheral:didDiscoverIncludedServicesForService:error\");\r\n  };\r\n  CBPeripheralDelegateImpl.prototype._getProperties = function(characteristic) {\r\n    var props = characteristic.properties;\r\n    return {\r\n      broadcast: (props & CBCharacteristicPropertyBroadcast) == CBCharacteristicPropertyBroadcast,\r\n      read: (props & CBCharacteristicPropertyRead) == CBCharacteristicPropertyRead,\r\n      broadcast2: (props & CBCharacteristicPropertyBroadcast) == CBCharacteristicPropertyBroadcast,\r\n      read2: (props & CBCharacteristicPropertyRead) == CBCharacteristicPropertyRead,\r\n      write: (props & CBCharacteristicPropertyWrite) == CBCharacteristicPropertyWrite,\r\n      writeWithoutResponse: (props & CBCharacteristicPropertyWriteWithoutResponse) == CBCharacteristicPropertyWriteWithoutResponse,\r\n      notify: (props & CBCharacteristicPropertyNotify) == CBCharacteristicPropertyNotify,\r\n      indicate: (props & CBCharacteristicPropertyIndicate) == CBCharacteristicPropertyIndicate,\r\n      authenticatedSignedWrites: (props & CBCharacteristicPropertyAuthenticatedSignedWrites) == CBCharacteristicPropertyAuthenticatedSignedWrites,\r\n      extendedProperties: (props & CBCharacteristicPropertyExtendedProperties) == CBCharacteristicPropertyExtendedProperties,\r\n      notifyEncryptionRequired: (props & CBCharacteristicPropertyNotifyEncryptionRequired) == CBCharacteristicPropertyNotifyEncryptionRequired,\r\n      indicateEncryptionRequired: (props & CBCharacteristicPropertyIndicateEncryptionRequired) == CBCharacteristicPropertyIndicateEncryptionRequired\r\n    };\r\n  };\r\n  CBPeripheralDelegateImpl.prototype._getDescriptors = function(characteristic) {\r\n    var descs = characteristic.descriptors;\r\n    var descsJs = [];\r\n    for (var i = 0; i < descs.count; i++) {\r\n      var desc = descs.objectAtIndex(i);\r\n      console.log(\"--------- descriptor value: \" + desc.value);\r\n      descsJs.push({\r\n        UUID: desc.UUID.UUIDString,\r\n        value: desc.value\r\n      });\r\n    }\r\n    return descsJs;\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidDiscoverCharacteristicsForServiceError = function(peripheral, service, error) {\r\n    if (error) {\r\n      // TODO invoke reject and stop processing\r\n      return;\r\n    }\r\n    var characteristics = [];\r\n    for (var i = 0; i < service.characteristics.count; i++) {\r\n      var characteristic = service.characteristics.objectAtIndex(i);\r\n      var result = {\r\n        UUID: characteristic.UUID.UUIDString,\r\n        name: characteristic.UUID,\r\n        // see serviceAndCharacteristicInfo in CBPer+Ext of Cordova plugin\r\n        value: characteristic.value ? characteristic.value.base64EncodedStringWithOptions(0) : null,\r\n        properties: this._getProperties(characteristic),\r\n        // descriptors: this._getDescriptors(characteristic), // TODO we're not currently discovering these\r\n        isNotifying: characteristic.isNotifying,\r\n        permissions: characteristic.permissions // prolly not too useful\r\n      };\r\n      characteristics.push(result);\r\n\r\n      for (var j=0; j<this._services.length; j++) {\r\n        var s = this._services[j];\r\n        if (s.UUID == service.UUID.UUIDString) {\r\n          s.characteristics = characteristics;\r\n          this._servicesWithCharacteristics.push(s);\r\n          // the same service may be found multiple times, so make sure it's not added yet\r\n          this._services.splice(j, 1);\r\n          break;\r\n        }\r\n      }\r\n\r\n      // Could add this one day: get details about the characteristic\r\n      // peripheral.discoverDescriptorsForCharacteristic(characteristic);\r\n    }\r\n   \r\n    if (this._services.length === 0) {\r\n      if (this._callback) {\r\n        this._callback({\r\n          UUID: peripheral.identifier.UUIDString,\r\n          name: peripheral.name,\r\n          state: Bluetooth._getState(peripheral.state),\r\n          services: this._servicesWithCharacteristics\r\n        });\r\n        this._callback = null;\r\n      }\r\n    }\r\n  };\r\n \r\n  CBPeripheralDelegateImpl.prototype._toArrayBuffer = function(value) {\r\n    if (value === null) {\r\n      return null;\r\n    }\r\n\r\n    // value is of ObjC type: NSData\r\n    var b = value.base64EncodedStringWithOptions(0);\r\n    return Bluetooth._base64ToArrayBuffer(b);\r\n  };\r\n\r\n  // this is called when a value is read from a peripheral\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidUpdateValueForCharacteristicError = function(peripheral, characteristic, error) {\r\n    if (!characteristic) {\r\n      console.log(\"^^^^^^^^ NO peripheralDidUpdateValueForCharacteristicError\");\r\n      return;\r\n    }\r\n    \r\n    if (error !== null) {\r\n      // TODO handle.. pass in sep callback?\r\n      console.log(\"------------ error @ peripheralDidUpdateValueForCharacteristicError!\");\r\n      return;\r\n    }\r\n\r\n    var result = {\r\n      type: characteristic.isNotifying ? \"notification\" : \"read\",\r\n      characteristicUUID: characteristic.UUID.UUIDString,\r\n      valueRaw: characteristic.value,\r\n      value: this._toArrayBuffer(characteristic.value)\r\n    };\r\n    \r\n    if (result.type === \"read\") {\r\n      if (this._onReadPromise) {\r\n        this._onReadPromise(result);\r\n      } else {\r\n      console.log(\"No _onReadPromise found!\");\r\n      }\r\n    } else {\r\n      if (this._onNotifyCallback) {\r\n        this._onNotifyCallback(result);\r\n      } else {\r\n        console.log(\"^^^^^^^^ CALLBACK IS GONE!\");\r\n      }\r\n    }\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidWriteValueForCharacteristicError = function(peripheral, characteristic, error) {\r\n    console.log(\"----- delegate peripheral:didWriteValueForCharacteristic:error\");\r\n    if (this._onWritePromise) {\r\n      this._onWritePromise({\r\n        characteristicUUID: characteristic.UUID.UUIDString\r\n      });\r\n    } else {\r\n      console.log(\"No _onWritePromise found!\");\r\n    }\r\n  };\r\n  \r\n  // The peripheral letting us know whether our subscribe/unsubscribe happened or not\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidUpdateNotificationStateForCharacteristicError = function(peripheral, characteristic, error) {\r\n    console.log(\"----- delegate peripheral:didUpdateNotificationStateForCharacteristic:error, error: \" + error);\r\n    // alert(\"peripheralDidUpdateNotificationStateForCharacteristicError\");\r\n    if (error) {\r\n      console.log(\"----- delegate peripheral:didUpdateNotificationStateForCharacteristic:error.localizedDescription, \" + error.localizedDescription);      \r\n    } else {\r\n      if (characteristic.isNotifying) {\r\n        console.log(\"------ Notification began on \" + characteristic);\r\n      } else {\r\n        console.log(\"------ Notification stopped on \" + characteristic + \", consider diconnecting\");\r\n        // Bluetooth._state.manager.cancelPeripheralConnection(peripheral);\r\n      }\r\n    }\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidDiscoverDescriptorsForCharacteristicError = function(peripheral, characteristic, error) {\r\n    \r\n    // NOTE that this cb won't be invoked bc we curr don't discover descriptors\r\n    \r\n    console.log(\"----- delegate peripheral:didDiscoverDescriptorsForCharacteristic:error\");\r\n    console.log(\"----- delegate peripheral:didDiscoverDescriptorsForCharacteristic:error characteristic.value: \" + characteristic.value);\r\n\r\n    // TODO extract details, see https://github.com/randdusing/cordova-plugin-bluetoothle/blob/master/src/ios/BluetoothLePlugin.m#L1844\r\n    console.log(characteristic.descriptors);\r\n    for (var i = 0; i < characteristic.descriptors.count; i++) {\r\n      var descriptor = characteristic.descriptors.objectAtIndex(i);\r\n      console.log(\"char desc UUID: \" + descriptor.UUID.UUIDString);\r\n    }\r\n\r\n    // now let's see if we're ready to invoke the callback\r\n    // TODO wait for the last one, THEN return\r\n    if (this._services.length == this._servicesWithCharacteristics.length) {\r\n      if (this._callback) {\r\n        this._callback({\r\n          UUID: peripheral.identifier.UUIDString,\r\n          name: peripheral.name,\r\n          state: Bluetooth._getState(peripheral.state),\r\n          services: this._services\r\n        });\r\n        this._callback = null;\r\n      }\r\n    }\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidUpdateValueForDescriptorError = function(peripheral, descriptor, error) {\r\n    console.log(\"----- delegate peripheral:didUpdateValueForDescriptor:error\");\r\n  };\r\n  CBPeripheralDelegateImpl.prototype.peripheralDidWriteValueForDescriptorError = function(peripheral, descriptor, error) {\r\n    console.log(\"----- delegate peripheral:didWriteValueForDescriptor:error\");\r\n  };\r\n  CBPeripheralDelegateImpl.ObjCProtocols = [CBPeripheralDelegate];\r\n  return CBPeripheralDelegateImpl;\r\n})(NSObject);\r\n\r\n\r\nvar CBCentralManagerDelegateImpl = (function (_super) {\r\n  __extends(CBCentralManagerDelegateImpl, _super);\r\n  function CBCentralManagerDelegateImpl() {\r\n    _super.apply(this, arguments);\r\n  }\r\n  CBCentralManagerDelegateImpl.new = function () {\r\n    return _super.new.call(this);\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.initWithCallback = function (callback) {\r\n    this._callback = callback;\r\n    return this;\r\n  };\r\n  // fires when a peripheral is discovered after executing the 'scan' function\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerDidDiscoverPeripheralAdvertisementDataRSSI = function(central, peripheral, advData, RSSI) {\r\n    console.log(\"----- delegate centralManager:didDiscoverPeripheral: \" + peripheral.name + \" @ \" + RSSI);\r\n    var peri = Bluetooth._findPeripheral(peripheral.identifier.UUIDString);\r\n    if (!peri) {\r\n      Bluetooth._state.peripheralArray.addObject(peripheral);\r\n      if (Bluetooth._state.onDiscovered) {\r\n        Bluetooth._state.onDiscovered({\r\n          UUID: peripheral.identifier.UUIDString,\r\n          name: peripheral.name,\r\n          RSSI: RSSI,\r\n          state: Bluetooth._getState(peripheral.state)\r\n        });\r\n      } else {\r\n        console.log(\"----- !!! No onDiscovered callback specified\");\r\n      }\r\n    }\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerDidUpdateState = function(central) {\r\n    console.log(\"----- delegate centralManagerDidUpdateState: \" + central.state);\r\n    if (central.state == CBCentralManagerStateUnsupported) {\r\n      console.log(\"WARNING: This hardware does not support Bluetooth Low Energy.\");\r\n    }\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerWillRestoreState = function(central, dict) {\r\n    console.log(\"----- delegate centralManager:willRestoreState\");\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerDidConnectPeripheral = function(central, peripheral) {\r\n    console.log(\"----- delegate centralManager:didConnectPeripheral: \" + peripheral);\r\n    \r\n    // find the peri in the array and attach the delegate to that\r\n    var peri = Bluetooth._findPeripheral(peripheral.identifier.UUIDString);\r\n    console.log(\"----- delegate centralManager:didConnectPeripheral: cached perio: \" + peri);\r\n    \r\n    var cb = Bluetooth._state.connectCallbacks[peripheral.identifier.UUIDString];\r\n    var delegate = CBPeripheralDelegateImpl.new().initWithCallback(cb);\r\n    CFRetain(delegate);\r\n    peri.delegate = delegate;\r\n    \r\n    console.log(\"----- delegate centralManager:didConnectPeripheral, let's discover service\");\r\n    peri.discoverServices(null);\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerDidDisconnectPeripheralError = function(central, peripheral, error) {\r\n    // this event needs to be honored by the client as any action afterwards crashes the app\r\n    var cb = Bluetooth._state.disconnectCallbacks[peripheral.identifier.UUIDString];\r\n    if (cb) {\r\n      cb({\r\n        UUID: peripheral.identifier.UUIDString,\r\n        name: peripheral.name\r\n      });\r\n    } else {\r\n      console.log(\"----- !!! no disconnect callback found\");      \r\n    }\r\n    var foundAt = Bluetooth._state.peripheralArray.indexOfObject(peripheral);\r\n    Bluetooth._state.peripheralArray.removeObject(foundAt);\r\n  };\r\n  CBCentralManagerDelegateImpl.prototype.centralManagerDidFailToConnectPeripheralError = function(central, peripheral, error) {\r\n    // TODO send event to JS\r\n    console.log(\"----- delegate centralManager:didFailToConnectPeripheral:error\");\r\n    // this._callback(error);\r\n  };\r\n  CBCentralManagerDelegateImpl.ObjCProtocols = [CBCentralManagerDelegate];\r\n  return CBCentralManagerDelegateImpl;\r\n})(NSObject);\r\n\r\n// check for bluetooth being enabled as soon as the app starts\r\n(function () {\r\n  Bluetooth._state.centralDelegate = CBCentralManagerDelegateImpl.new().initWithCallback(function (obj) {\r\n    console.log(\"----- centralDelegate obj: \" + obj);\r\n  });\r\n  // TODO options? https://github.com/randdusing/cordova-plugin-bluetoothle/blob/master/src/ios/BluetoothLePlugin.m#L187\r\n  Bluetooth._state.manager = CBCentralManager.alloc().initWithDelegateQueue(Bluetooth._state.centralDelegate, null);\r\n})();\r\n\r\nBluetooth._isEnabled = function (arg) {\r\n  return Bluetooth._state.manager.state == CBCentralManagerStatePoweredOn;\r\n};\r\n\r\nBluetooth._getState = function(stateId) {\r\n  if (stateId == CBPeripheralStateConnecting) {\r\n    return 'connecting';\r\n  } else if (stateId == CBPeripheralStateConnected) {\r\n    return 'connected';\r\n  } else if (stateId == CBPeripheralStateDisconnected) {\r\n    return 'disconnected';\r\n  } else {\r\n    console.log(\"Unexpected state, returning 'disconnected': \" + stateId);\r\n    return 'disconnected';\r\n  }\r\n};\r\n\r\nBluetooth.isBluetoothEnabled = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      resolve(Bluetooth._isEnabled());\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.isBluetoothEnabled: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.startScanning = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!Bluetooth._isEnabled()) {\r\n        reject(\"Bluetooth is not enabled\");\r\n        return;\r\n      }\r\n      Bluetooth._state.peripheralArray = NSMutableArray.new();\r\n\r\n      // TODO actualy, should init the delegate here with this as the callback (see 'onConnected') --> but first test if that works\r\n      Bluetooth._state.onDiscovered = arg.onDiscovered;\r\n      var serviceUUIDs = arg.serviceUUIDs || [];\r\n     \r\n      var services = [];\r\n      for (var s in serviceUUIDs) {\r\n        services.push(CBUUID.UUIDWithString(serviceUUIDs[s]));\r\n      }\r\n      Bluetooth._state.manager.scanForPeripheralsWithServicesOptions(services, null);\r\n      if (arg.seconds) {\r\n        setTimeout(function() {\r\n          // note that by now a manual 'stop' may have been invoked, but that doesn't hurt\r\n          Bluetooth._state.manager.stopScan();\r\n          resolve();\r\n        }, arg.seconds * 1000);\r\n      } else {\r\n        resolve();\r\n      }\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.startScanning: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.stopScanning = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!Bluetooth._isEnabled()) {\r\n        reject(\"Bluetooth is not enabled\");\r\n        return;\r\n      }\r\n      Bluetooth._state.manager.stopScan();\r\n      resolve();\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.stopScanning: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth._findPeripheral = function(UUID) {\r\n  for (var i = 0; i < Bluetooth._state.peripheralArray.count; i++) {\r\n    var peripheral = Bluetooth._state.peripheralArray.objectAtIndex(i);\r\n    if (UUID == peripheral.identifier.UUIDString) {\r\n      return peripheral;\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\n// note that this doesn't make much sense without scanning first\r\nBluetooth.connect = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!Bluetooth._isEnabled()) {\r\n        reject(\"Bluetooth is not enabled\");\r\n        return;\r\n      }\r\n      if (!arg.UUID) {\r\n        reject(\"No UUID was passed\");\r\n        return;\r\n      }\r\n      var peripheral = Bluetooth._findPeripheral(arg.UUID);\r\n      if (peripheral === null) {\r\n        reject(\"Could not find peripheral with UUID \" + arg.UUID);\r\n      } else {\r\n        console.log(\"Connecting to peripheral with UUID: \" + arg.UUID);\r\n        Bluetooth._state.connectCallbacks[arg.UUID] = arg.onConnected;\r\n        Bluetooth._state.disconnectCallbacks[arg.UUID] = arg.onDisconnected;\r\n        Bluetooth._state.manager.connectPeripheralOptions(peripheral, null);\r\n        resolve();\r\n      }\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.connect: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.disconnect = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!Bluetooth._isEnabled()) {\r\n        reject(\"Bluetooth is not enabled\");\r\n        return;\r\n      }\r\n      if (!arg.UUID) {\r\n        reject(\"No UUID was passed\");\r\n        return;\r\n      }\r\n      var peripheral = Bluetooth._findPeripheral(arg.UUID);\r\n      if (peripheral === null) {\r\n        reject(\"Could not find peripheral with UUID \" + arg.UUID);\r\n      } else {\r\n        console.log(\"Disconnecting peripheral with UUID: \" + arg.UUID);\r\n        // no need to send an error when already disconnected, but it's wise to check it\r\n        if (peripheral.state != CBPeripheralStateDisconnected) {\r\n          Bluetooth._state.manager.cancelPeripheralConnection(peripheral);\r\n          peripheral.delegate = null;\r\n          // TODO remove from the peripheralArray as well\r\n        }\r\n        resolve();\r\n      }\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.disconnect: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.isConnected = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!Bluetooth._isEnabled()) {\r\n        reject(\"Bluetooth is not enabled\");\r\n        return;\r\n      }\r\n      if (!arg.UUID) {\r\n        reject(\"No UUID was passed\");\r\n        return;\r\n      }\r\n      var peripheral = Bluetooth._findPeripheral(arg.UUID);\r\n      if (peripheral === null) {\r\n        reject(\"Could not find peripheral with UUID \" + arg.UUID);\r\n      } else {\r\n        console.log(\"checking connection with peripheral UUID: \" + arg.UUID);\r\n        resolve(peripheral.state == CBPeripheralStateConnected);\r\n      }\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.isConnected: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth._findService = function (UUID, peripheral) {\r\n  for (var i = 0; i < peripheral.services.count; i++) {\r\n    var service = peripheral.services.objectAtIndex(i);\r\n    // console.log(\"--- service.UUID: \" + service.UUID);\r\n    // TODO this may need a different compare, see Cordova plugin's findServiceFromUUID function\r\n    if (UUID.UUIDString == service.UUID.UUIDString) {\r\n      // console.log(\"--- found our service with UUID: \" + service.UUID);\r\n      return service;\r\n    }\r\n  }\r\n  // service not found on this peripheral\r\n  return null;\r\n};\r\n\r\nBluetooth._findCharacteristic = function (UUID, service, property) {\r\n  // console.log(\"--- _findCharacteristic UUID: \" + UUID);\r\n  // console.log(\"--- _findCharacteristic service: \" + service);\r\n  console.log(\"--- _findCharacteristic characteristics: \" + service.characteristics);\r\n  // console.log(\"--- _findCharacteristic characteristics.count: \" + service.characteristics.count);\r\n  for (var i = 0; i < service.characteristics.count; i++) {\r\n    var characteristic = service.characteristics.objectAtIndex(i);\r\n    // console.log(\"--- characteristic.UUID: \" + characteristic.UUID);\r\n    if (UUID.UUIDString == characteristic.UUID.UUIDString) {\r\n      if (property) {\r\n        if ((characteristic.properties & property) == property) {\r\n          // console.log(\"--- characteristic.found: \" + characteristic.UUID);\r\n          return characteristic;\r\n        }\r\n      } else {\r\n        return characteristic;\r\n      }\r\n    }\r\n  }\r\n  // characteristic not found on this service\r\n  console.log(\"--- characteristic.NOT.found!\");\r\n  return null;\r\n};\r\n\r\nBluetooth._getWrapper = function (arg, property, reject) {\r\n  if (!Bluetooth._isEnabled()) {\r\n    reject(\"Bluetooth is not enabled\");\r\n    return;\r\n  }\r\n  if (!arg.peripheralUUID) {\r\n    reject(\"No peripheralUUID was passed\");\r\n    return null;\r\n  }\r\n  if (!arg.serviceUUID) {\r\n    reject(\"No serviceUUID was passed\");\r\n    return null;\r\n  }\r\n  if (!arg.characteristicUUID) {\r\n    reject(\"No characteristicUUID was passed\");\r\n    return null;\r\n  }\r\n\r\n  var peripheral = Bluetooth._findPeripheral(arg.peripheralUUID);\r\n  if (!peripheral) {\r\n    reject(\"Could not find peripheral with UUID \" + arg.peripheralUUID);\r\n    return null;\r\n  }\r\n\r\n  if (peripheral.state != CBPeripheralStateConnected) {\r\n    reject(\"The peripheral is disconnected\");\r\n    return null;\r\n  }\r\n\r\n  var serviceUUID = CBUUID.UUIDWithString(arg.serviceUUID);\r\n  var service = Bluetooth._findService(serviceUUID, peripheral);\r\n  if (!service) {\r\n    reject(\"Could not find service with UUID \" + arg.serviceUUID + \" on peripheral with UUID \" + arg.peripheralUUID);\r\n    return null;\r\n  }\r\n\r\n  var characteristicUUID = CBUUID.UUIDWithString(arg.characteristicUUID);\r\n  var characteristic = Bluetooth._findCharacteristic(characteristicUUID, service, property);\r\n\r\n  // Special handling for INDICATE. If charateristic with notify is not found, check for indicate.\r\n  if (property == CBCharacteristicPropertyNotify && !characteristic) {\r\n    characteristic = Bluetooth._findCharacteristic(characteristicUUID, service, CBCharacteristicPropertyIndicate);\r\n  }\r\n\r\n  // As a last resort, try and find ANY characteristic with this UUID, even if it doesn't have the correct properties\r\n  if (!characteristic) {\r\n    characteristic = Bluetooth._findCharacteristic(characteristicUUID, service);\r\n  }\r\n\r\n  if (!characteristic) {\r\n    reject(\"Could not find characteristic with UUID \" + arg.characteristicUUID + \" on service with UUID \" + arg.serviceUUID + \" on peripheral with UUID \" + arg.peripheralUUID);\r\n    return null;\r\n  }\r\n\r\n  // with that all being checked, let's return a wrapper object containing all the stuff we found here\r\n  return {\r\n    peripheral: peripheral,\r\n    service: service,\r\n    characteristic: characteristic\r\n  };\r\n};\r\n\r\nBluetooth.read = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      var wrapper = Bluetooth._getWrapper(arg, CBCharacteristicPropertyRead, reject);\r\n      if (wrapper === null) {\r\n        // no need to reject, this has already been done\r\n        return;\r\n      }\r\n\r\n      // TODO we could (should?) make this characteristic-specific\r\n      wrapper.peripheral.delegate._onReadPromise = resolve;\r\n      wrapper.peripheral.readValueForCharacteristic(wrapper.characteristic);\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.read: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.startNotifying = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      var wrapper = Bluetooth._getWrapper(arg, CBCharacteristicPropertyNotify, reject);\r\n      console.log(\"--------- startNotifying wrapper: \" + wrapper);\r\n\r\n      if (wrapper === null) {\r\n        // no need to reject, this has already been done\r\n        return;\r\n      }\r\n      var cb = arg.onNotify || function(result) { console.log(\"No 'onNotify' callback function specified for 'startNotifying'\"); };\r\n\r\n      // TODO we could (should?) make this characteristic-specific\r\n      wrapper.peripheral.delegate._onNotifyCallback = cb;\r\n      wrapper.peripheral.setNotifyValueForCharacteristic(true, wrapper.characteristic);\r\n      resolve();\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.startNotifying: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.stopNotifying = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      var wrapper = Bluetooth._getWrapper(arg, CBCharacteristicPropertyNotify, reject);\r\n      console.log(\"--------- stopNotifying wrapper: \" + wrapper);\r\n\r\n      if (wrapper === null) {\r\n        // no need to reject, this has already been done\r\n        return;\r\n      }\r\n\r\n      var peripheral = Bluetooth._findPeripheral(arg.peripheralUUID);\r\n      // peripheral.delegate = null;\r\n      peripheral.setNotifyValueForCharacteristic(false, wrapper.characteristic);\r\n      resolve();\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.stopNotifying: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\n// val must be a Uint8Array or Uint16Array or a string like '0x01' or '0x007F' or '0x01,0x02', or '0x007F,'0x006F''\r\nBluetooth._encodeValue = function(val) {\r\n  // if it's not a string assume it's a UintXArray\r\n  if (typeof val != 'string') {\r\n    return val.buffer;\r\n  }\r\n  var parts = val.split(',');\r\n  if (parts[0].indexOf('x') == -1) {\r\n    return null;\r\n  }\r\n  var result;\r\n  if (parts[0].length == 4) { // eg. 0x01\r\n    result = new Uint8Array(parts.length);\r\n  } else {\r\n    // assuming eg. 0x007F\r\n    result = new Uint16Array(parts.length);\r\n  }\r\n  for (var i=0; i<parts.length; i++) {\r\n    result[i] = parts[i];\r\n  }\r\n  return result.buffer;\r\n};\r\n\r\nBluetooth.write = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!arg.value) {\r\n        reject(\"You need to provide some data to write in the 'value' property\");\r\n        return;\r\n      }\r\n      var wrapper = Bluetooth._getWrapper(arg, CBCharacteristicPropertyWrite, reject);\r\n      if (wrapper === null) {\r\n        // no need to reject, this has already been done\r\n        return;\r\n      }\r\n\r\n      var valueEncoded = Bluetooth._encodeValue(arg.value);\r\n      if (valueEncoded === null) {\r\n        reject(\"Invalid value: \" + arg.value);\r\n        return;\r\n      }\r\n\r\n      // the promise will be resolved from 'didWriteValueForCharacteristic',\r\n      // but we should make this characteristic-specific (see .read)\r\n      wrapper.peripheral.delegate._onWritePromise = resolve;\r\n\r\n      wrapper.peripheral.writeValueForCharacteristicType(\r\n        valueEncoded,\r\n        wrapper.characteristic,\r\n        CBCharacteristicWriteWithResponse);\r\n\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.write: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n\r\nBluetooth.writeWithoutResponse = function (arg) {\r\n  return new Promise(function (resolve, reject) {\r\n    try {\r\n      if (!arg.value) {\r\n        reject(\"You need to provide some data to write in the 'value' property\");\r\n        return;\r\n      }\r\n      var wrapper = Bluetooth._getWrapper(arg, CBCharacteristicPropertyWriteWithoutResponse, reject);\r\n      if (wrapper === null) {\r\n        // no need to reject, this has already been done\r\n        return;\r\n      }\r\n\r\n      var valueEncoded = Bluetooth._encodeValue(arg.value);\r\n      console.log(\"Attempting to write (encoded): \" + valueEncoded);\r\n      \r\n      wrapper.peripheral.writeValueForCharacteristicType(\r\n        valueEncoded,\r\n        wrapper.characteristic,\r\n        CBCharacteristicWriteWithoutResponse);\r\n\r\n      resolve();\r\n    } catch (ex) {\r\n      console.log(\"Error in Bluetooth.writeWithoutResponse: \" + ex);\r\n      reject(ex);\r\n    }\r\n  });\r\n};\r\n"],"sourceRoot":"/source/"}